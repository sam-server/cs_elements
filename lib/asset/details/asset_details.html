<!DOCTYPE html>

<link rel="import" href="../../../../packages/polymer/polymer.html">

<link rel="import"
	href="../../../../packages/core_elements/core_input.html">
<link rel="import"
	href="../../../../packages/core_elements/core_icons.html">
	
<link rel="import"
  href="../../../../packages/polymer_ajax_form/ajax_form.html">

<link rel="import" href="../../inputs/money_input.html">
<link rel="import" href="../../generic/input_decorator/input_decorator.html">
<link rel="import" href="../../generic/optional_image/optional_image.html">

<link rel="import" href="../../qrcode/qrcode.html">
<link rel="import" href="../../form_controls/form_controls.html">

<polymer-element name="asset-details"> 
<template>
<link rel="stylesheet" href="../../generic/common.css">
<link rel="stylesheet" href="asset_details.css">

<form is="ajax-form" id="mainform" 
      action="{{create ? '/asset/create' : asset.href}}"
      method="{{create ? 'POST' : 'PUT'}}" enctype="application/json"
      headers="{{session.sessionHeaders}}"
      layout vertical flex>
   <header layout horizontal center-justified>
     <div flex style="flex: 2" layout horizontal>
      `<cs-qrcode value="{{asset.href}}" height="96" width="96"></cs-qrcode>
	     <template if="{{!create}}">
	      <h1 layout horizontal center start-justified flex>{{asset.name}}</h1></template>
	     <template if="{{create}}">
	      <h1 layout horizontal center start-justified flex>New asset</h1>
	     </template>
	   </div>
     <div flex style="flex: 1">
     <template if="{{asset.isDirty}}">
		    <div id="submitCancelContainer" layout horizontal center-justified>
		      <button id="saveButton" on-click="{{saveAssetChanges}}">Save</button>
		      <button on-click="{{resetAssetChanges}}">Reset</button>
		    </div>
		 </template>
		 </div>
   </header>
   
   <div id="innerContent" layout horizontal flex>
	   <div class="detailsContainer" layout vertical flex>
	     <template if="{{create}}">
	       <input-decorator icon="perm-identity">
	         <input is="core-input" type="text" name="name" value="{{asset.name}}" placeholder="Name">
	       </input-decorator>
	     </template>
	       <input-decorator icon="assignment" class="descriptionDecorator">
	         <textarea name="description" value="{{asset.description}}" placeholder="Description"></textarea>
	       </input-decorator>
	       <input-decorator iconsrc="../../../../packages/cs_elements/inputs/money_icon.svg">
	         <money-input name="price" value="{{asset.price}}" placeholder="Price"></money-input>
	       </input-decorator>
	     <input-decorator iconsrc="../../../../packages/cs_elements/generic/icons/Wrench_font_awesome.svg">
	       <input is="core-input" type="text" name="use" value="{{asset.use}}" placeholder="Use">
	     </input-decorator>
	     <input-decorator>
	       <input is="core-input" type="text" name="model_number" value="{{asset.modelNumber}}" placeholder="Model number">
	     </input-decorator>
	   </div>
	   <div class="detailsContainer padLeft" layout vertical flex center>
	     <optional-image src="{{asset.imageSrc}}"></optional-image>
	     <!-- TODO: Should changing the image be a separate operation? -->
	     <input type="file" accept="image/*" capture name="image">
	     <button id="fileSelect" on-click="{{captureImage}}">Change image</button>
	     
       
	   </div>
   </div>
  
   <input type="hidden" name="kind" value="assets#asset">  
</form>
</template> 
<script type="application/dart" src="asset_details.dart"></script> 
</polymer-element>
